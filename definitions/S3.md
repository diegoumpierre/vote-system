# Amazon S3 (Simple Storage Service)

## What It Is

Amazon S3 is AWS's object storage service—a highly scalable, durable, and available storage system designed to store and retrieve any amount of data from anywhere. Unlike file systems or block storage, S3 stores data as objects (files) within containers called buckets. Each object consists of data, metadata, and a unique identifier (key).

S3 is not a traditional file system—there are no directories, no mounting, no POSIX permissions. It's accessed via HTTP/HTTPS APIs, making it ideal for cloud-native applications, static websites, backups, data lakes, and content distribution.

## How It Works

S3 organizes data into **buckets** (top-level containers) and **objects** (individual files). Each object is identified by a key (like a file path: `images/vote-receipt.png`) and stored within a bucket (like `voting-system-assets`).

```
Application
    ↓
S3 API (PUT/GET/DELETE)
    ↓
S3 Bucket (e.g., voting-system-assets)
    ↓
Objects (e.g., /receipts/user123.pdf, /images/logo.png)
```

**Mechanism:** When you upload an object, S3 automatically replicates it across multiple availability zones within a region (99.999999999% durability—11 nines). You don't manage servers, disks, or RAID arrays—AWS handles all the infrastructure. Access is via REST API, AWS SDKs, or AWS CLI.

### Key Concepts

- **Bucket**: Globally unique namespace container (e.g., `my-voting-system` must be unique across all AWS accounts)
- **Object**: The actual file/data stored (up to 5TB per object)
- **Key**: Unique identifier within a bucket (supports "folder-like" prefixes: `receipts/2024/user123.pdf`)
- **Versioning**: Keep multiple versions of the same object (protect against accidental deletes/overwrites)
- **Lifecycle Policies**: Automatically transition objects to cheaper storage classes or delete after time
- **Access Control**: IAM policies, bucket policies, ACLs, pre-signed URLs for temporary access

## Storage Classes

S3 offers multiple storage classes optimized for different access patterns and cost profiles:

| Storage Class | Use Case | Retrieval Time | Cost (per GB/month) |
|--------------|----------|----------------|---------------------|
| **S3 Standard** | Frequently accessed data, low latency | Milliseconds | ~$0.023 |
| **S3 Intelligent-Tiering** | Unknown or changing access patterns | Milliseconds | ~$0.023 + monitoring fee |
| **S3 Standard-IA** | Infrequently accessed, but rapid access when needed | Milliseconds | ~$0.0125 + retrieval fee |
| **S3 One Zone-IA** | Infrequent access, non-critical data | Milliseconds | ~$0.01 + retrieval fee |
| **S3 Glacier Instant Retrieval** | Archive with instant access | Milliseconds | ~$0.004 + retrieval fee |
| **S3 Glacier Flexible Retrieval** | Archive, retrieval in minutes-hours | Minutes to hours | ~$0.0036 + retrieval fee |
| **S3 Glacier Deep Archive** | Long-term archive, rare access | 12-48 hours | ~$0.00099 + retrieval fee |

## Pros / Cons

| Aspect | Pros | Cons |
|--------|------|------|
| **Durability** | 99.999999999% (11 nines) durability, automatic cross-AZ replication | Not a replacement for databases (no transactional consistency, no indexes) |
| **Scalability** | Unlimited storage, scales automatically, no capacity planning | S3 API rate limits (3,500 PUT/5,500 GET per second per prefix by default) |
| **Cost** | Extremely cheap for storage (~$0.023/GB/month standard, less for infrequent) | Costs add up with frequent access (GET/PUT requests, data transfer out) |
| **Availability** | 99.99% availability SLA, highly resilient | Eventual consistency for overwrite PUTS and DELETES (now strong consistency) |
| **Integration** | Deep AWS integration (CloudFront, Lambda, Athena, EMR, etc.) | Not suitable for high-IOPS transactional workloads (use EBS/EFS instead) |
| **Simplicity** | No server management, no disk provisioning, fully managed | Learning curve for proper IAM policies and bucket security |

## When to Use S3

Use S3 when you need to:

- **Store static assets**: Images, videos, CSS, JavaScript for web applications
- **Host static websites**: S3 + CloudFront = serverless website hosting
- **Backup and disaster recovery**: Database backups, application backups, snapshots
- **Data lakes**: Store raw data for analytics (query with Athena, process with EMR)
- **Log storage**: Application logs, CloudTrail logs, VPC Flow Logs
- **User-generated content**: Vote receipts, profile pictures, uploaded documents
- **Content distribution**: Source for CloudFront CDN

### Don't Use S3 If

- You need file system semantics (use EFS or FSx instead)
- You need block-level storage for EC2 (use EBS instead)
- You need sub-millisecond latency (use ElastiCache or DynamoDB)
- You need transactional consistency across multiple objects (use RDS or DynamoDB)

## Practical Example: Voting System Storage

For a voting platform, S3 would typically handle:

1. **Static Website Assets**
   - Bucket: `voting-system-frontend`
   - Objects: `index.html`, `app.js`, `styles.css`, `images/logo.png`
   - Config: Public read access, CloudFront distribution in front
   - Storage Class: S3 Standard

2. **Vote Receipts / Audit Trail**
   - Bucket: `voting-system-receipts`
   - Objects: `receipts/2024/election-id/user-id.pdf`
   - Config: Versioning enabled, lifecycle policy (Standard → Glacier after 90 days)
   - Access: Pre-signed URLs for temporary user access

3. **Application Logs**
   - Bucket: `voting-system-logs`
   - Objects: `alb-logs/2024/12/16/log-file.gz`
   - Config: Lifecycle policy (delete after 365 days)
   - Storage Class: S3 Standard-IA (infrequent access)

4. **Database Backups**
   - Bucket: `voting-system-backups`
   - Objects: `rds-backups/2024-12-16-snapshot.sql.gz`
   - Config: Versioning enabled, lifecycle policy (Glacier after 30 days)
   - Storage Class: S3 Standard → Glacier Flexible Retrieval

### Example Bucket Policy: Secure Receipt Storage

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Deny",
      "Principal": "*",
      "Action": "s3:*",
      "Resource": "arn:aws:s3:::voting-system-receipts/*",
      "Condition": {
        "Bool": {
          "aws:SecureTransport": "false"
        }
      }
    },
    {
      "Effect": "Allow",
      "Principal": {
        "AWS": "arn:aws:iam::ACCOUNT-ID:role/VotingAppRole"
      },
      "Action": ["s3:GetObject", "s3:PutObject"],
      "Resource": "arn:aws:s3:::voting-system-receipts/receipts/*"
    }
  ]
}
```

This policy enforces HTTPS and restricts access to only the application role.

## Pricing

S3 pricing has multiple components:

### Storage Costs
- **S3 Standard**: $0.023 per GB/month (first 50TB)
- **S3 Standard-IA**: $0.0125 per GB/month
- **S3 Glacier Flexible**: $0.0036 per GB/month
- **S3 Glacier Deep Archive**: $0.00099 per GB/month

### Request Costs
- **PUT/POST/COPY**: $0.005 per 1,000 requests
- **GET/SELECT**: $0.0004 per 1,000 requests
- **Lifecycle transitions**: $0.01 per 1,000 transitions

### Data Transfer Costs
- **Data IN**: Free
- **Data OUT to internet**: $0.09 per GB (first 10TB/month)
- **Data OUT to CloudFront**: Free
- **Cross-region replication**: $0.02 per GB

### Cost Estimation Example

Voting system with 100GB static assets + 500GB receipts:
- Storage: 100GB Standard ($2.30) + 500GB Standard-IA ($6.25) = $8.55/month
- Requests: 10M GET requests ($4.00) + 100K PUT requests ($0.50) = $4.50/month
- Data transfer: 50GB out to internet ($4.50/month)
- **Total**: ~$17.55/month

### Cost Optimization Tips

- **Use S3 Intelligent-Tiering** for unpredictable access patterns (auto-moves to IA)
- **Enable lifecycle policies** to move old data to Glacier automatically
- **Use CloudFront** for frequently accessed content (reduces S3 GET costs)
- **Compress objects** before uploading (reduces storage and transfer costs)
- **Delete incomplete multipart uploads** (use lifecycle policy)
- **Use S3 Inventory** to analyze storage patterns and optimize

## Security Best Practices

1. **Block Public Access**: Enable by default, use pre-signed URLs for temporary access
2. **Encrypt at Rest**: Enable S3-managed encryption (SSE-S3) or KMS (SSE-KMS)
3. **Encrypt in Transit**: Enforce HTTPS in bucket policies
4. **Versioning**: Enable for critical data (protects against accidental deletes)
5. **MFA Delete**: Require MFA to delete object versions (extra protection)
6. **Logging**: Enable S3 access logs or CloudTrail for audit trail
7. **IAM Policies**: Use least-privilege principle, avoid wildcard permissions

## Integration with Other Services

S3 integrates with virtually every AWS service:

- **CloudFront**: CDN distribution, edge caching, DDoS protection
- **Lambda**: Event-driven processing (trigger on object upload)
- **Athena**: Query S3 data using SQL (serverless data lake)
- **EMR**: Big data processing (Spark, Hadoop) on S3 data
- **Glue**: ETL jobs, data cataloging
- **CloudWatch**: Metrics, alarms for bucket activity
- **IAM**: Fine-grained access control
- **KMS**: Encryption key management
- **SNS/SQS**: Event notifications for object changes

## Conclusion

S3 is the foundational storage service in AWS—it's cheap, durable, scalable, and integrated with nearly every other AWS service. For a voting system, S3 is essential for:

- **Static website hosting** (serverless frontend)
- **Audit trail storage** (vote receipts, compliance requirements)
- **Backup and disaster recovery** (database snapshots, config backups)
- **Log aggregation** (centralized log storage for analysis)

The key is understanding storage classes and lifecycle policies to optimize costs. Most voting data falls into two categories:
1. **Hot data** (current election, frequently accessed) → S3 Standard
2. **Cold data** (past elections, compliance archive) → S3 Glacier

For a kata/architectural exercise, S3 demonstrates understanding of:
- Separation of concerns (static assets vs application logic)
- Cost optimization (right storage class for access pattern)
- Security (encryption, access control, audit logging)
- Compliance (versioning, immutability, retention policies)

It's not just a storage service—it's the backbone of serverless architectures, data lakes, and disaster recovery strategies in AWS.
